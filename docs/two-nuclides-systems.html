<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Two nuclides systems | Interpreting TCN concentrations at the Earth Surface</title>
  <meta name="description" content="This book presents a set of simple exercises and hands on activity to familiarize students with the interpretation of measured Terrestrial Nuclides Concentrations in Earth Surface material" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Two nuclides systems | Interpreting TCN concentrations at the Earth Surface" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book presents a set of simple exercises and hands on activity to familiarize students with the interpretation of measured Terrestrial Nuclides Concentrations in Earth Surface material" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Two nuclides systems | Interpreting TCN concentrations at the Earth Surface" />
  
  <meta name="twitter:description" content="This book presents a set of simple exercises and hands on activity to familiarize students with the interpretation of measured Terrestrial Nuclides Concentrations in Earth Surface material" />
  

<meta name="author" content="Vincent Godard" />


<meta name="date" content="2022-10-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="application-to-denudation-rate-measurements.html"/>
<link rel="next" href="depth-profiles.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="assets/pagedtable-1.1/js/pagedtable.js"></script>
<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="assets/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="assets/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-1.3.1/leaflet.js"></script>
<link href="assets/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="assets/proj4-2.6.2/proj4.min.js"></script>
<script src="assets/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="assets/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="assets/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="assets/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="assets/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front page</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#terrestrial-cosmogenic-nuclides-and-earth-surface-dynamics"><i class="fa fa-check"></i><b>1.1</b> Terrestrial Cosmogenic Nuclides and Earth Surface Dynamics</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#scope-and-objectives"><i class="fa fa-check"></i><b>1.2</b> Scope and objectives</a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#working-with-this-web-site"><i class="fa fa-check"></i><b>1.3</b> Working with this web site</a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#getting-started-with-rrstudio"><i class="fa fa-check"></i><b>1.4</b> Getting started with R/RStudio</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="introduction.html"><a href="introduction.html#local-installation"><i class="fa fa-check"></i><b>1.4.1</b> Local installation</a></li>
<li class="chapter" data-level="1.4.2" data-path="introduction.html"><a href="introduction.html#binder"><i class="fa fa-check"></i><b>1.4.2</b> Binder</a></li>
<li class="chapter" data-level="1.4.3" data-path="introduction.html"><a href="introduction.html#rstudio-cloud"><i class="fa fa-check"></i><b>1.4.3</b> RStudio Cloud</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#usage"><i class="fa fa-check"></i><b>1.5</b> Usage</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="scaling-factors.html"><a href="scaling-factors.html"><i class="fa fa-check"></i><b>2</b> Scaling factors</a>
<ul>
<li class="chapter" data-level="2.1" data-path="scaling-factors.html"><a href="scaling-factors.html#time-independent-scaling"><i class="fa fa-check"></i><b>2.1</b> Time-independent scaling</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="scaling-factors.html"><a href="scaling-factors.html#site-characteristics"><i class="fa fa-check"></i><b>2.1.1</b> Site characteristics</a></li>
<li class="chapter" data-level="2.1.2" data-path="scaling-factors.html"><a href="scaling-factors.html#computation-of-scaling-factors"><i class="fa fa-check"></i><b>2.1.2</b> Computation of scaling factors</a></li>
<li class="chapter" data-level="2.1.3" data-path="scaling-factors.html"><a href="scaling-factors.html#global-variations"><i class="fa fa-check"></i><b>2.1.3</b> Global variations</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="scaling-factors.html"><a href="scaling-factors.html#time-dependent-scalings"><i class="fa fa-check"></i><b>2.2</b> Time-dependent scalings</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="scaling-factors.html"><a href="scaling-factors.html#definition-of-paleomagnetic-variations"><i class="fa fa-check"></i><b>2.2.1</b> Definition of paleomagnetic variations</a></li>
<li class="chapter" data-level="2.2.2" data-path="scaling-factors.html"><a href="scaling-factors.html#lalstone-modified-scaling-lm"><i class="fa fa-check"></i><b>2.2.2</b> Lal/Stone modified scaling (<em>lm</em>)</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="scaling-factors.html"><a href="scaling-factors.html#interactive-shiny-app"><i class="fa fa-check"></i><b>2.3</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html"><i class="fa fa-check"></i><b>3</b> Exploring TCN build up at the surface</a>
<ul>
<li class="chapter" data-level="3.1" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#background"><i class="fa fa-check"></i><b>3.1</b> Background</a></li>
<li class="chapter" data-level="3.2" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#set-up-of-the-calculations"><i class="fa fa-check"></i><b>3.2</b> Set up of the calculations</a></li>
<li class="chapter" data-level="3.3" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#evolution-of-concentration-with-time"><i class="fa fa-check"></i><b>3.3</b> Evolution of concentration with time</a></li>
<li class="chapter" data-level="3.4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#two-end-member-situations"><i class="fa fa-check"></i><b>3.4</b> Two end-member situations</a></li>
<li class="chapter" data-level="3.5" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#comparing-the-eulerian-and-lagrangian-descriptions"><i class="fa fa-check"></i><b>3.5</b> Comparing the Eulerian and Lagrangian descriptions</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#definition-of-the-denudation-scenario"><i class="fa fa-check"></i><b>3.5.1</b> Definition of the denudation scenario</a></li>
<li class="chapter" data-level="3.5.2" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#computation-of-concentrations-with-the-eulerian-reference-frame"><i class="fa fa-check"></i><b>3.5.2</b> Computation of concentrations with the Eulerian reference frame</a></li>
<li class="chapter" data-level="3.5.3" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#computation-of-concentrations-with-the-lagrangian-reference-frame"><i class="fa fa-check"></i><b>3.5.3</b> Computation of concentrations with the Lagrangian reference frame</a></li>
<li class="chapter" data-level="3.5.4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#comparison-of-results"><i class="fa fa-check"></i><b>3.5.4</b> Comparison of results</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#interactive-shiny-app-1"><i class="fa fa-check"></i><b>3.6</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html"><i class="fa fa-check"></i><b>4</b> Application to exposure dating</a>
<ul>
<li class="chapter" data-level="4.1" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#back-to-the-evolution-of-concentration"><i class="fa fa-check"></i><b>4.1</b> Back to the evolution of concentration</a></li>
<li class="chapter" data-level="4.2" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#interpretation-in-terms-of-exposure-ages"><i class="fa fa-check"></i><b>4.2</b> Interpretation in terms of exposure ages</a></li>
<li class="chapter" data-level="4.3" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#time-varying-production-rates"><i class="fa fa-check"></i><b>4.3</b> Time varying production rates</a></li>
<li class="chapter" data-level="4.4" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#dealing-with-uncertainties"><i class="fa fa-check"></i><b>4.4</b> Dealing with uncertainties</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html"><i class="fa fa-check"></i><b>5</b> Application to denudation rate measurements</a>
<ul>
<li class="chapter" data-level="5.1" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#concentration---denudation-rate-relationship"><i class="fa fa-check"></i><b>5.1</b> Concentration - denudation rate relationship</a></li>
<li class="chapter" data-level="5.2" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#calculation-of-denudation-rates"><i class="fa fa-check"></i><b>5.2</b> Calculation of denudation rates</a></li>
<li class="chapter" data-level="5.3" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#integration-time-scale"><i class="fa fa-check"></i><b>5.3</b> Integration time scale</a></li>
<li class="chapter" data-level="5.4" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#catchment-wide-denudation-rates"><i class="fa fa-check"></i><b>5.4</b> Catchment wide denudation rates</a></li>
<li class="chapter" data-level="5.5" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#change-in-denudation-through-time"><i class="fa fa-check"></i><b>5.5</b> Change in denudation through time</a></li>
<li class="chapter" data-level="5.6" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#on-the-importance-of-muons"><i class="fa fa-check"></i><b>5.6</b> On the importance of muons</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html"><i class="fa fa-check"></i><b>6</b> Two nuclides systems</a>
<ul>
<li class="chapter" data-level="6.1" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#evolution-of-ratios"><i class="fa fa-check"></i><b>6.1</b> Evolution of ratios</a></li>
<li class="chapter" data-level="6.2" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#steady-state-denudation-and-constant-exposure-curves"><i class="fa fa-check"></i><b>6.2</b> Steady-state denudation and constant exposure curves</a></li>
<li class="chapter" data-level="6.3" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#burial-age-and-denudation-rate-curves"><i class="fa fa-check"></i><b>6.3</b> Burial age and denudation rate curves</a></li>
<li class="chapter" data-level="6.4" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#exemple-of-lombrive-cave-ariège"><i class="fa fa-check"></i><b>6.4</b> Exemple of Lombrive cave (Ariège)</a></li>
<li class="chapter" data-level="6.5" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#interactive-shiny-app-2"><i class="fa fa-check"></i><b>6.5</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="depth-profiles.html"><a href="depth-profiles.html"><i class="fa fa-check"></i><b>7</b> Depth profiles</a>
<ul>
<li class="chapter" data-level="7.1" data-path="depth-profiles.html"><a href="depth-profiles.html#setup-and-dataset"><i class="fa fa-check"></i><b>7.1</b> Setup and dataset</a></li>
<li class="chapter" data-level="7.2" data-path="depth-profiles.html"><a href="depth-profiles.html#profile-modelling"><i class="fa fa-check"></i><b>7.2</b> Profile modelling</a></li>
<li class="chapter" data-level="7.3" data-path="depth-profiles.html"><a href="depth-profiles.html#exploration-of-parameters-space"><i class="fa fa-check"></i><b>7.3</b> Exploration of parameters space</a></li>
<li class="chapter" data-level="7.4" data-path="depth-profiles.html"><a href="depth-profiles.html#interactive-shiny-app-3"><i class="fa fa-check"></i><b>7.4</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>8</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Interpreting TCN concentrations at the Earth Surface</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-nuclides-systems" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">6</span> Two nuclides systems<a href="two-nuclides-systems.html#two-nuclides-systems" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We first define the usual variables and parameters.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="two-nuclides-systems.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb99-2"><a href="two-nuclides-systems.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb99-3"><a href="two-nuclides-systems.html#cb99-3" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb99-4"><a href="two-nuclides-systems.html#cb99-4" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb99-5"><a href="two-nuclides-systems.html#cb99-5" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">40</span> <span class="co"># latitude in degrees</span></span>
<span id="cb99-6"><a href="two-nuclides-systems.html#cb99-6" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb99-7"><a href="two-nuclides-systems.html#cb99-7" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span></code></pre></div>
</details>
<p>Here first we consider that all samples are close and have similar positions and elevation, so similar scaling parameters.
We will see later how to deal with situations where samples have different positions and hence different scaling parameters.</p>
<p>In order to avoid messing up things later we define here once and for all which is nuclide 1 and which is nuclide 2, according to their respective <span class="math inline">\(\tau_{1/2}\)</span> :</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="two-nuclides-systems.html#cb100-1" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># longer half-life</span></span>
<span id="cb100-2"><a href="two-nuclides-systems.html#cb100-2" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">=</span> <span class="st">&quot;Al26&quot;</span> <span class="co"># shorter half-life</span></span></code></pre></div>
</details>
<div id="evolution-of-ratios" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Evolution of ratios<a href="two-nuclides-systems.html#evolution-of-ratios" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We first start by looking into the evolution of the isotopic ratio between the nuclides, once production has stopped, which is one of the key phenomenon used in burial dating applications.</p>
<p>We will look at the evolution through time (typically over several Ma for the 26/10 system), starting from concentrations defined by a denudation steady-state.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="two-nuclides-systems.html#cb101-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">7e6</span>,<span class="at">by=</span><span class="dv">2000</span>))</span>
<span id="cb101-2"><a href="two-nuclides-systems.html#cb101-2" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="dv">50</span> <span class="sc">*</span> rho <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> <span class="fl">1e6</span> <span class="co"># in g/cm2/a</span></span></code></pre></div>
</details>
<p>We compute the initial steady-state concentrations.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="two-nuclides-systems.html#cb102-1" aria-hidden="true" tabindex="-1"></a>C1_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N1],S,Lambda)</span>
<span id="cb102-2"><a href="two-nuclides-systems.html#cb102-2" aria-hidden="true" tabindex="-1"></a>C2_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N2],S,Lambda)</span></code></pre></div>
</details>
<p>Now we let them decay through time starting from the initial values, with no production (<span class="math inline">\(z=+\infty\)</span>).</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="two-nuclides-systems.html#cb103-1" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C1 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C1_0,prm[,N1],S,Lambda)</span>
<span id="cb103-2"><a href="two-nuclides-systems.html#cb103-2" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C2 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C2_0,prm[,N2],S,Lambda)</span></code></pre></div>
</details>
<p>We plot the evolution of the ratio through time.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="two-nuclides-systems.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>t,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time (a)&quot;</span>,<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/tn5b-1.png" width="672" /></p>
<div class="codebox codeimage">
<p>Below you can get all the necessary code to produce the figure</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb105-1"><a href="two-nuclides-systems.html#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TCNtools&quot;</span>)</span>
<span id="cb105-2"><a href="two-nuclides-systems.html#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb105-3"><a href="two-nuclides-systems.html#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb105-4"><a href="two-nuclides-systems.html#cb105-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb105-5"><a href="two-nuclides-systems.html#cb105-5" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb105-6"><a href="two-nuclides-systems.html#cb105-6" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">40</span> <span class="co"># latitude in degrees</span></span>
<span id="cb105-7"><a href="two-nuclides-systems.html#cb105-7" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb105-8"><a href="two-nuclides-systems.html#cb105-8" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span>
<span id="cb105-9"><a href="two-nuclides-systems.html#cb105-9" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># longer half-life</span></span>
<span id="cb105-10"><a href="two-nuclides-systems.html#cb105-10" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">=</span> <span class="st">&quot;Al26&quot;</span> <span class="co"># shorter half-life</span></span>
<span id="cb105-11"><a href="two-nuclides-systems.html#cb105-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">7e6</span>,<span class="at">by=</span><span class="dv">2000</span>))</span>
<span id="cb105-12"><a href="two-nuclides-systems.html#cb105-12" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="dv">50</span> <span class="sc">*</span> rho <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> <span class="fl">1e6</span> <span class="co"># in g/cm2/a</span></span>
<span id="cb105-13"><a href="two-nuclides-systems.html#cb105-13" aria-hidden="true" tabindex="-1"></a>C1_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N1],S,Lambda)</span>
<span id="cb105-14"><a href="two-nuclides-systems.html#cb105-14" aria-hidden="true" tabindex="-1"></a>C2_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N2],S,Lambda)</span>
<span id="cb105-15"><a href="two-nuclides-systems.html#cb105-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C1 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C1_0,prm[,N1],S,Lambda)</span>
<span id="cb105-16"><a href="two-nuclides-systems.html#cb105-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C2 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C2_0,prm[,N2],S,Lambda)</span>
<span id="cb105-17"><a href="two-nuclides-systems.html#cb105-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(data<span class="sc">$</span>t,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time (a)&quot;</span>,<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span></code></pre></div>
</details>
</div>
<div class="actionbox actionimage">
<p>Change the following parameters and observe the implication on the ratio and its evolution
- location (<code>altitude</code> and <code>latitude</code>)
- initial denudation rate (<code>ero</code>)</p>
</div>
</div>
<div id="steady-state-denudation-and-constant-exposure-curves" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Steady-state denudation and constant exposure curves<a href="two-nuclides-systems.html#steady-state-denudation-and-constant-exposure-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Two-nuclides plots are usually built around two curves representing the predictions, in terms of concentrations, for end-member simplified situations :</p>
<ul>
<li><strong>steady-state denudation</strong>, where the concentrations of the nuclides of interest are computed for various values of surface denudation rates</li>
<li><strong>constant exposure</strong>, where the concentrations of the nuclides of interest are computed for various duration of surface exposition, with no denudation</li>
</ul>
<p>We will use the Eulerian point of view (function <code>solv_conc_eul</code>) to compute the concentrations, which is done by function <code>tnp_curves</code>.</p>
<p>We compute the data for these two curves.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="two-nuclides-systems.html#cb106-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">tnp_curves</span>(prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">dlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">1000</span>),<span class="at">alim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e+09</span>))</span>
<span id="cb106-2"><a href="two-nuclides-systems.html#cb106-2" aria-hidden="true" tabindex="-1"></a>ss_ero <span class="ot">=</span> tmp[[<span class="dv">1</span>]]</span>
<span id="cb106-3"><a href="two-nuclides-systems.html#cb106-3" aria-hidden="true" tabindex="-1"></a>cst_exp <span class="ot">=</span> tmp[[<span class="dv">2</span>]]</span></code></pre></div>
</details>
<p>The default parameters for the ranges of denudation rates and exposure ages can be adjusted if needed.</p>
<p>Now that we can plot everything in a two-nuclides graph.
While not mandatory, it is usually recommended to organize the plot this way :</p>
<ul>
<li><strong>X-axis</strong> : longer half-life nuclide (our <span class="math inline">\(N_1\)</span>)</li>
<li><strong>Y-axis</strong> : ratio of shorter to longer half-life nuclides (our <span class="math inline">\(N_2/N_1\)</span>)</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="two-nuclides-systems.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C1),<span class="at">ylim=</span><span class="fu">range</span>(<span class="dv">1</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb107-2"><a href="two-nuclides-systems.html#cb107-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb107-3"><a href="two-nuclides-systems.html#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb107-4"><a href="two-nuclides-systems.html#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb107-5"><a href="two-nuclides-systems.html#cb107-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(data<span class="sc">$</span>C1,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/tn7-1.png" width="672" /></p>
<div class="codebox codeimage">
<p>Below you can get all the necessary code to produce the figure</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb108"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb108-1"><a href="two-nuclides-systems.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TCNtools&quot;</span>)</span>
<span id="cb108-2"><a href="two-nuclides-systems.html#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb108-3"><a href="two-nuclides-systems.html#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb108-4"><a href="two-nuclides-systems.html#cb108-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb108-5"><a href="two-nuclides-systems.html#cb108-5" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb108-6"><a href="two-nuclides-systems.html#cb108-6" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">40</span> <span class="co"># latitude in degrees</span></span>
<span id="cb108-7"><a href="two-nuclides-systems.html#cb108-7" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb108-8"><a href="two-nuclides-systems.html#cb108-8" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span>
<span id="cb108-9"><a href="two-nuclides-systems.html#cb108-9" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># longer half-life</span></span>
<span id="cb108-10"><a href="two-nuclides-systems.html#cb108-10" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">=</span> <span class="st">&quot;Al26&quot;</span> <span class="co"># shorter half-life</span></span>
<span id="cb108-11"><a href="two-nuclides-systems.html#cb108-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">7e6</span>,<span class="at">by=</span><span class="dv">2000</span>))</span>
<span id="cb108-12"><a href="two-nuclides-systems.html#cb108-12" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="dv">50</span> <span class="sc">*</span> rho <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> <span class="fl">1e6</span> <span class="co"># in g/cm2/a</span></span>
<span id="cb108-13"><a href="two-nuclides-systems.html#cb108-13" aria-hidden="true" tabindex="-1"></a>C1_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N1],S,Lambda)</span>
<span id="cb108-14"><a href="two-nuclides-systems.html#cb108-14" aria-hidden="true" tabindex="-1"></a>C2_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N2],S,Lambda)</span>
<span id="cb108-15"><a href="two-nuclides-systems.html#cb108-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C1 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C1_0,prm[,N1],S,Lambda)</span>
<span id="cb108-16"><a href="two-nuclides-systems.html#cb108-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C2 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C2_0,prm[,N2],S,Lambda)</span>
<span id="cb108-17"><a href="two-nuclides-systems.html#cb108-17" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">tnp_curves</span>(prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">dlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">1000</span>),<span class="at">alim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e+09</span>))</span>
<span id="cb108-18"><a href="two-nuclides-systems.html#cb108-18" aria-hidden="true" tabindex="-1"></a>ss_ero <span class="ot">=</span> tmp[[<span class="dv">1</span>]]</span>
<span id="cb108-19"><a href="two-nuclides-systems.html#cb108-19" aria-hidden="true" tabindex="-1"></a>cst_exp <span class="ot">=</span> tmp[[<span class="dv">2</span>]]</span>
<span id="cb108-20"><a href="two-nuclides-systems.html#cb108-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C1),<span class="at">ylim=</span><span class="fu">range</span>(<span class="dv">1</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb108-21"><a href="two-nuclides-systems.html#cb108-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb108-22"><a href="two-nuclides-systems.html#cb108-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb108-23"><a href="two-nuclides-systems.html#cb108-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb108-24"><a href="two-nuclides-systems.html#cb108-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(data<span class="sc">$</span>C1,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
</details>
</div>
<p>We have also plotted the burial trajectory we generated above.
Starting from a position on the steady-state denudation curve, we progressively lower the ratios.</p>
<p>Note that you can adjust the extent of the curves by modifying the range in denudation rate (option <code>dlim</code>, default from 0.1 to 1000 m/Ma) in exposure duration (option <code>alim</code>, default from 100 a to 1 Ma).</p>
<div class="actionbox actionimage">
<p>Again change the following parameters and observe the implications on plot
- location (<code>altitude</code> and <code>latitude</code>)
- initial denudation rate (<code>ero</code>)</p>
</div>
</div>
<div id="burial-age-and-denudation-rate-curves" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Burial age and denudation rate curves<a href="two-nuclides-systems.html#burial-age-and-denudation-rate-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>It is also common practice in such plot to overlays network of curves, indicating for example burial age.
The <code>tnp_burial</code> function allows to compute such curves.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="two-nuclides-systems.html#cb109-1" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e6</span> <span class="co"># increments in age (a)</span></span>
<span id="cb109-2"><a href="two-nuclides-systems.html#cb109-2" aria-hidden="true" tabindex="-1"></a>E <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>) <span class="co"># increments in denudation rate (m/Ma)</span></span>
<span id="cb109-3"><a href="two-nuclides-systems.html#cb109-3" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">tnp_burial</span>(A,E,prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">n=</span><span class="dv">100</span>) <span class="co"># compute array</span></span></code></pre></div>
</details>
<p>We plot these lines on our two nuclides plot.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="two-nuclides-systems.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C1),<span class="at">ylim=</span><span class="fu">range</span>(<span class="dv">0</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb110-2"><a href="two-nuclides-systems.html#cb110-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb110-3"><a href="two-nuclides-systems.html#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,res[[<span class="dv">1</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># constant age</span></span>
<span id="cb110-4"><a href="two-nuclides-systems.html#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,res[[<span class="dv">2</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>) <span class="co"># constant denudation</span></span>
<span id="cb110-5"><a href="two-nuclides-systems.html#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb110-6"><a href="two-nuclides-systems.html#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb110-7"><a href="two-nuclides-systems.html#cb110-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-8"><a href="two-nuclides-systems.html#cb110-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(data<span class="sc">$</span>C1,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/tn9-1.png" width="672" /></p>
<div class="codebox codeimage">
<p>Below you can get all the necessary code to produce the figure</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb111-1"><a href="two-nuclides-systems.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TCNtools&quot;</span>)</span>
<span id="cb111-2"><a href="two-nuclides-systems.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb111-3"><a href="two-nuclides-systems.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb111-4"><a href="two-nuclides-systems.html#cb111-4" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb111-5"><a href="two-nuclides-systems.html#cb111-5" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb111-6"><a href="two-nuclides-systems.html#cb111-6" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">40</span> <span class="co"># latitude in degrees</span></span>
<span id="cb111-7"><a href="two-nuclides-systems.html#cb111-7" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb111-8"><a href="two-nuclides-systems.html#cb111-8" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span>
<span id="cb111-9"><a href="two-nuclides-systems.html#cb111-9" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># longer half-life</span></span>
<span id="cb111-10"><a href="two-nuclides-systems.html#cb111-10" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">=</span> <span class="st">&quot;Al26&quot;</span> <span class="co"># shorter half-life</span></span>
<span id="cb111-11"><a href="two-nuclides-systems.html#cb111-11" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">7e6</span>,<span class="at">by=</span><span class="dv">2000</span>))</span>
<span id="cb111-12"><a href="two-nuclides-systems.html#cb111-12" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="dv">50</span> <span class="sc">*</span> rho <span class="sc">*</span> <span class="dv">100</span> <span class="sc">/</span> <span class="fl">1e6</span> <span class="co"># in g/cm2/a</span></span>
<span id="cb111-13"><a href="two-nuclides-systems.html#cb111-13" aria-hidden="true" tabindex="-1"></a>C1_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N1],S,Lambda)</span>
<span id="cb111-14"><a href="two-nuclides-systems.html#cb111-14" aria-hidden="true" tabindex="-1"></a>C2_0 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,ero,<span class="cn">Inf</span>,<span class="dv">0</span>,prm[,N2],S,Lambda)</span>
<span id="cb111-15"><a href="two-nuclides-systems.html#cb111-15" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C1 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C1_0,prm[,N1],S,Lambda)</span>
<span id="cb111-16"><a href="two-nuclides-systems.html#cb111-16" aria-hidden="true" tabindex="-1"></a>data<span class="sc">$</span>C2 <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="cn">Inf</span>,<span class="dv">0</span>,data<span class="sc">$</span>t,C2_0,prm[,N2],S,Lambda)</span>
<span id="cb111-17"><a href="two-nuclides-systems.html#cb111-17" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">tnp_curves</span>(prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">dlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">1000</span>),<span class="at">alim =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="fl">1e+09</span>))</span>
<span id="cb111-18"><a href="two-nuclides-systems.html#cb111-18" aria-hidden="true" tabindex="-1"></a>ss_ero <span class="ot">=</span> tmp[[<span class="dv">1</span>]]</span>
<span id="cb111-19"><a href="two-nuclides-systems.html#cb111-19" aria-hidden="true" tabindex="-1"></a>cst_exp <span class="ot">=</span> tmp[[<span class="dv">2</span>]]</span>
<span id="cb111-20"><a href="two-nuclides-systems.html#cb111-20" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e6</span> <span class="co"># increments in age (a)</span></span>
<span id="cb111-21"><a href="two-nuclides-systems.html#cb111-21" aria-hidden="true" tabindex="-1"></a>E <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>,<span class="dv">2000</span>) <span class="co"># increments in denudation rate (m/Ma)</span></span>
<span id="cb111-22"><a href="two-nuclides-systems.html#cb111-22" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">tnp_burial</span>(A,E,prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">n=</span><span class="dv">100</span>) <span class="co"># compute array</span></span>
<span id="cb111-23"><a href="two-nuclides-systems.html#cb111-23" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C1),<span class="at">ylim=</span><span class="fu">range</span>(<span class="dv">0</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb111-24"><a href="two-nuclides-systems.html#cb111-24" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb111-25"><a href="two-nuclides-systems.html#cb111-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,res[[<span class="dv">1</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># constant age</span></span>
<span id="cb111-26"><a href="two-nuclides-systems.html#cb111-26" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,res[[<span class="dv">2</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>) <span class="co"># constant denudation</span></span>
<span id="cb111-27"><a href="two-nuclides-systems.html#cb111-27" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb111-28"><a href="two-nuclides-systems.html#cb111-28" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb111-29"><a href="two-nuclides-systems.html#cb111-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-30"><a href="two-nuclides-systems.html#cb111-30" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(data<span class="sc">$</span>C1,data<span class="sc">$</span>C2<span class="sc">/</span>data<span class="sc">$</span>C1,<span class="at">lwd=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange&quot;</span>)</span></code></pre></div>
</details>
</div>
<div class="questionbox questionimage">
<p>Comment on the general structure of the plot and our ability to resolve burial ages.</p>
</div>
</div>
<div id="exemple-of-lombrive-cave-ariège" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Exemple of Lombrive cave (Ariège)<a href="two-nuclides-systems.html#exemple-of-lombrive-cave-ariège" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are going to use data from <span class="citation">Sartégou et al. (<a href="references.html#ref-sartegou2020late" role="doc-biblioref">2020</a>)</span>, obtained by measuring <span class="math inline">\(^{10}Be\)</span> and <span class="math inline">\(^{26}\)</span>Al concentrations in caves deposits from the Lombrives system, 114 m above the current level of the Ariège river.</p>
<div id="htmlwidget-f7b49dfb15c87506c75b" style="width:672px;height:480px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-f7b49dfb15c87506c75b">{"x":{"options":{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}}},"calls":[{"method":"addTiles","args":["https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",null,null,{"minZoom":0,"maxZoom":18,"tileSize":256,"subdomains":"abc","errorTileUrl":"","tms":false,"noWrap":false,"zoomOffset":0,"zoomReverse":false,"opacity":1,"zIndex":1,"detectRetina":false,"attribution":"&copy; <a href=\"https://openstreetmap.org\">OpenStreetMap<\/a> contributors, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA<\/a>"}]},{"method":"addProviderTiles","args":["OpenStreetMap",null,"OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addProviderTiles","args":["Esri.WorldImagery",null,"Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false}]},{"method":"addLayersControl","args":[["OpenStreetMap","Esri.WorldImagery"],[],{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addMarkers","args":[42.823389,1.616056,{"iconUrl":{"data":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGP6zwAAAgcBApocMXEAAAAASUVORK5CYII=","index":0},"iconWidth":1,"iconHeight":1},null,null,{"interactive":true,"draggable":false,"keyboard":true,"title":"","alt":"","zIndexOffset":0,"opacity":1,"riseOnHover":false,"riseOffset":250},null,null,null,null,"Lombrives",{"interactive":false,"permanent":true,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]}],"limits":{"lat":[42.823389,42.823389],"lng":[1.616056,1.616056]}},"evals":[],"jsHooks":[]}</script>
<p>We start by loading the data (note that concentrations are in <span class="math inline">\(\times 10^3\)</span> at/g).</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="two-nuclides-systems.html#cb112-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/VincentGodard/TCNbook/main/data/sartegou2020late.dat&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb112-2"><a href="two-nuclides-systems.html#cb112-2" aria-hidden="true" tabindex="-1"></a>data</span></code></pre></div>
</details>
<p>We also recompute the paramters according to location of Lombrive cave and the estimated average elevation of the paleo-catchment (see discussion in the article).</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="two-nuclides-systems.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb113-2"><a href="two-nuclides-systems.html#cb113-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb113-3"><a href="two-nuclides-systems.html#cb113-3" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.5</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb113-4"><a href="two-nuclides-systems.html#cb113-4" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1990</span> <span class="co"># elevation in m</span></span>
<span id="cb113-5"><a href="two-nuclides-systems.html#cb113-5" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">43</span> <span class="co"># latitude in degrees</span></span>
<span id="cb113-6"><a href="two-nuclides-systems.html#cb113-6" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb113-7"><a href="two-nuclides-systems.html#cb113-7" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span></code></pre></div>
</details>
<p>We also recompute the various reference curves of the plot.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="two-nuclides-systems.html#cb114-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">tnp_curves</span>(prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">dlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">1000</span>),<span class="at">alim =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="fl">1e+09</span>))</span>
<span id="cb114-2"><a href="two-nuclides-systems.html#cb114-2" aria-hidden="true" tabindex="-1"></a>ss_ero <span class="ot">=</span> tmp[[<span class="dv">1</span>]]</span>
<span id="cb114-3"><a href="two-nuclides-systems.html#cb114-3" aria-hidden="true" tabindex="-1"></a>cst_exp <span class="ot">=</span> tmp[[<span class="dv">2</span>]]</span>
<span id="cb114-4"><a href="two-nuclides-systems.html#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb114-5"><a href="two-nuclides-systems.html#cb114-5" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e6</span> <span class="co"># increments in age (a)</span></span>
<span id="cb114-6"><a href="two-nuclides-systems.html#cb114-6" aria-hidden="true" tabindex="-1"></a>E <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>) <span class="co"># increments in denudation rate (m/Ma)</span></span>
<span id="cb114-7"><a href="two-nuclides-systems.html#cb114-7" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">tnp_burial</span>(A,E,prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">n=</span><span class="dv">100</span>) <span class="co"># compute array</span></span></code></pre></div>
</details>
<p>We now can plot the dataset.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="two-nuclides-systems.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(<span class="fl">1e4</span>,<span class="fl">2e5</span>),<span class="at">ylim=</span><span class="fu">range</span>(<span class="fl">0.01</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb115-2"><a href="two-nuclides-systems.html#cb115-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb115-3"><a href="two-nuclides-systems.html#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,res[[<span class="dv">1</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># constant age</span></span>
<span id="cb115-4"><a href="two-nuclides-systems.html#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,res[[<span class="dv">2</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>) <span class="co"># constant denudation</span></span>
<span id="cb115-5"><a href="two-nuclides-systems.html#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb115-6"><a href="two-nuclides-systems.html#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb115-7"><a href="two-nuclides-systems.html#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb115-8"><a href="two-nuclides-systems.html#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>,data<span class="sc">$</span>C26<span class="sc">/</span>data<span class="sc">$</span>C10,<span class="at">pch=</span><span class="dv">21</span>,<span class="at">bg=</span><span class="st">&quot;pink&quot;</span>,<span class="at">cex=</span><span class="dv">2</span>)</span>
<span id="cb115-9"><a href="two-nuclides-systems.html#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>,data<span class="sc">$</span>C26<span class="sc">/</span>data<span class="sc">$</span>C10,data<span class="sc">$</span>num,<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/tn13-1.png" width="672" /></p>
<p>Note that we have modified the X-axis extent with respect to previous plots.
Analytical uncertainties are critical to interpret such plots, especially for long burial duration.
We are going to plot them as ellispes, using the function <code>tnp_ellipse</code>.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="two-nuclides-systems.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(<span class="fl">1e4</span>,<span class="fl">2e5</span>),<span class="at">ylim=</span><span class="fu">range</span>(<span class="fl">0.01</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb116-2"><a href="two-nuclides-systems.html#cb116-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb116-3"><a href="two-nuclides-systems.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,res[[<span class="dv">1</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># constant age</span></span>
<span id="cb116-4"><a href="two-nuclides-systems.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,res[[<span class="dv">2</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>) <span class="co"># constant denudation</span></span>
<span id="cb116-5"><a href="two-nuclides-systems.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb116-6"><a href="two-nuclides-systems.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb116-7"><a href="two-nuclides-systems.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb116-8"><a href="two-nuclides-systems.html#cb116-8" aria-hidden="true" tabindex="-1"></a>el <span class="ot">=</span> <span class="fu">tnp_ellipse</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C10_e<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C26<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C26_e<span class="sc">*</span><span class="fl">1e3</span>,<span class="at">confidence=</span><span class="fl">0.68</span>)</span>
<span id="cb116-9"><a href="two-nuclides-systems.html#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(el)) {<span class="fu">polygon</span>(el[[i]],<span class="at">col=</span><span class="st">&quot;pink&quot;</span>,<span class="at">border=</span><span class="st">&quot;grey&quot;</span>)}</span>
<span id="cb116-10"><a href="two-nuclides-systems.html#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>,data<span class="sc">$</span>C26<span class="sc">/</span>data<span class="sc">$</span>C10,data<span class="sc">$</span>num,<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/tn14-1.png" width="672" /></p>
<div class="codebox codeimage">
<p>Below you can get all the necessary code to produce the figure</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r fold-hide"><code class="sourceCode r"><span id="cb117-1"><a href="two-nuclides-systems.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;TCNtools&quot;</span>)</span>
<span id="cb117-2"><a href="two-nuclides-systems.html#cb117-2" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># longer half-life</span></span>
<span id="cb117-3"><a href="two-nuclides-systems.html#cb117-3" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">=</span> <span class="st">&quot;Al26&quot;</span> <span class="co"># shorter half-life</span></span>
<span id="cb117-4"><a href="two-nuclides-systems.html#cb117-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">=</span> <span class="fu">read.table</span>(<span class="st">&quot;https://raw.githubusercontent.com/VincentGodard/TCNbook/main/data/sartegou2020late.dat&quot;</span>,<span class="at">header=</span>T)</span>
<span id="cb117-5"><a href="two-nuclides-systems.html#cb117-5" aria-hidden="true" tabindex="-1"></a>data</span>
<span id="cb117-6"><a href="two-nuclides-systems.html#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb117-7"><a href="two-nuclides-systems.html#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb117-8"><a href="two-nuclides-systems.html#cb117-8" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.5</span> <span class="co"># we also define the density (g/cm3)</span></span>
<span id="cb117-9"><a href="two-nuclides-systems.html#cb117-9" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1990</span> <span class="co"># elevation in m</span></span>
<span id="cb117-10"><a href="two-nuclides-systems.html#cb117-10" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">43</span> <span class="co"># latitude in degrees</span></span>
<span id="cb117-11"><a href="two-nuclides-systems.html#cb117-11" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb117-12"><a href="two-nuclides-systems.html#cb117-12" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span>
<span id="cb117-13"><a href="two-nuclides-systems.html#cb117-13" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">=</span> <span class="fu">tnp_curves</span>(prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">dlim =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">1000</span>),<span class="at">alim =</span> <span class="fu">c</span>(<span class="dv">1000</span>, <span class="fl">1e+09</span>))</span>
<span id="cb117-14"><a href="two-nuclides-systems.html#cb117-14" aria-hidden="true" tabindex="-1"></a>ss_ero <span class="ot">=</span> tmp[[<span class="dv">1</span>]]</span>
<span id="cb117-15"><a href="two-nuclides-systems.html#cb117-15" aria-hidden="true" tabindex="-1"></a>cst_exp <span class="ot">=</span> tmp[[<span class="dv">2</span>]]</span>
<span id="cb117-16"><a href="two-nuclides-systems.html#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb117-17"><a href="two-nuclides-systems.html#cb117-17" aria-hidden="true" tabindex="-1"></a>A <span class="ot">=</span> (<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)<span class="sc">*</span><span class="fl">1e6</span> <span class="co"># increments in age (a)</span></span>
<span id="cb117-18"><a href="two-nuclides-systems.html#cb117-18" aria-hidden="true" tabindex="-1"></a>E <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">500</span>,<span class="dv">1000</span>) <span class="co"># increments in denudation rate (m/Ma)</span></span>
<span id="cb117-19"><a href="two-nuclides-systems.html#cb117-19" aria-hidden="true" tabindex="-1"></a>res <span class="ot">=</span> <span class="fu">tnp_burial</span>(A,E,prm[,N1],prm[,N2],Lambda,S,rho,<span class="at">n=</span><span class="dv">100</span>) <span class="co"># compute array</span></span>
<span id="cb117-20"><a href="two-nuclides-systems.html#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(<span class="fl">1e4</span>,<span class="fl">2e5</span>),<span class="at">ylim=</span><span class="fu">range</span>(<span class="fl">0.01</span>,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1),<span class="at">log=</span><span class="st">&quot;x&quot;</span>,</span>
<span id="cb117-21"><a href="two-nuclides-systems.html#cb117-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">paste</span>(N1,<span class="st">&quot;(at/g)&quot;</span>),<span class="at">ylab=</span><span class="fu">paste</span>(N2,<span class="st">&quot;/&quot;</span>,N1))</span>
<span id="cb117-22"><a href="two-nuclides-systems.html#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,res[[<span class="dv">1</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">1</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="co"># constant age</span></span>
<span id="cb117-23"><a href="two-nuclides-systems.html#cb117-23" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,res[[<span class="dv">2</span>]]<span class="sc">$</span>C2<span class="sc">/</span>res[[<span class="dv">2</span>]]<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;grey&quot;</span>) <span class="co"># constant denudation</span></span>
<span id="cb117-24"><a href="two-nuclides-systems.html#cb117-24" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(cst_exp<span class="sc">$</span>C1,cst_exp<span class="sc">$</span>C2<span class="sc">/</span>cst_exp<span class="sc">$</span>C1,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># constant exposure, dashed line</span></span>
<span id="cb117-25"><a href="two-nuclides-systems.html#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(ss_ero<span class="sc">$</span>C1,ss_ero<span class="sc">$</span>C2<span class="sc">/</span>ss_ero<span class="sc">$</span>C1,<span class="at">col=</span><span class="st">&quot;khaki4&quot;</span>) <span class="co"># steady-state erosion, solid line</span></span>
<span id="cb117-26"><a href="two-nuclides-systems.html#cb117-26" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb117-27"><a href="two-nuclides-systems.html#cb117-27" aria-hidden="true" tabindex="-1"></a>el <span class="ot">=</span> <span class="fu">tnp_ellipse</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C10_e<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C26<span class="sc">*</span><span class="fl">1e3</span>, data<span class="sc">$</span>C26_e<span class="sc">*</span><span class="fl">1e3</span>,<span class="at">confidence=</span><span class="fl">0.68</span>)</span>
<span id="cb117-28"><a href="two-nuclides-systems.html#cb117-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(el)) {<span class="fu">polygon</span>(el[[i]],<span class="at">col=</span><span class="st">&quot;pink&quot;</span>,<span class="at">border=</span><span class="st">&quot;grey&quot;</span>)}</span>
<span id="cb117-29"><a href="two-nuclides-systems.html#cb117-29" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(data<span class="sc">$</span>C10<span class="sc">*</span><span class="fl">1e3</span>,data<span class="sc">$</span>C26<span class="sc">/</span>data<span class="sc">$</span>C10,data<span class="sc">$</span>num,<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
</details>
</div>
<div class="questionbox questionimage">
<p>Comment on the implications for the burial ages and paleo-denudation rates.</p>
</div>
</div>
<div id="interactive-shiny-app-2" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Interactive shiny app<a href="two-nuclides-systems.html#interactive-shiny-app-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also explore dynamically 2 nuclides plots using this embedded application, which use the same type of code.</p>
<iframe src="https://shinyproxy.osupytheas.fr/2_nuclides/" width="672" height="1200px" data-external="1">
</iframe>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="application-to-denudation-rate-measurements.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="depth-profiles.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
