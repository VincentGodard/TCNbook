<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Exploring TCN build up at the surface | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Exploring TCN build up at the surface | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Exploring TCN build up at the surface | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Vincent Godard" />


<meta name="date" content="2022-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="scaling-factors.html"/>
<link rel="next" href="application-to-exposure-dating.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#objectives-of-the-session"><i class="fa fa-check"></i><b>2.1</b> Objectives of the session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scaling-factors.html"><a href="scaling-factors.html"><i class="fa fa-check"></i><b>3</b> Scaling factors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scaling-factors.html"><a href="scaling-factors.html#time-independent-scaling"><i class="fa fa-check"></i><b>3.1</b> Time-independent scaling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scaling-factors.html"><a href="scaling-factors.html#site-characteristics"><i class="fa fa-check"></i><b>3.1.1</b> Site characteristics</a></li>
<li class="chapter" data-level="3.1.2" data-path="scaling-factors.html"><a href="scaling-factors.html#computation-of-scaling-factors"><i class="fa fa-check"></i><b>3.1.2</b> Computation of scaling factors</a></li>
<li class="chapter" data-level="3.1.3" data-path="scaling-factors.html"><a href="scaling-factors.html#global-variations"><i class="fa fa-check"></i><b>3.1.3</b> Global variations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scaling-factors.html"><a href="scaling-factors.html#time-dependent-scalings"><i class="fa fa-check"></i><b>3.2</b> Time-dependent scalings</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scaling-factors.html"><a href="scaling-factors.html#definition-of-paleomagnetic-variations"><i class="fa fa-check"></i><b>3.2.1</b> Definition of paleomagnetic variations</a></li>
<li class="chapter" data-level="3.2.2" data-path="scaling-factors.html"><a href="scaling-factors.html#lalstone-modified-scaling-lm"><i class="fa fa-check"></i><b>3.2.2</b> Lal/Stone modified scaling (<em>lm</em>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scaling-factors.html"><a href="scaling-factors.html#interactive-shiny-app"><i class="fa fa-check"></i><b>3.3</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html"><i class="fa fa-check"></i><b>4</b> Exploring TCN build up at the surface</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#background"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#set-up-of-the-calculations"><i class="fa fa-check"></i><b>4.2</b> Set up of the calculations</a></li>
<li class="chapter" data-level="4.3" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#evolution-of-concentration-with-time"><i class="fa fa-check"></i><b>4.3</b> Evolution of concentration with time</a></li>
<li class="chapter" data-level="4.4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#two-end-member-situations"><i class="fa fa-check"></i><b>4.4</b> Two end-member situations</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#interactive-shiny-app-1"><i class="fa fa-check"></i><b>4.5</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html"><i class="fa fa-check"></i><b>5</b> Application to exposure dating</a>
<ul>
<li class="chapter" data-level="5.1" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#back-to-the-evolution-of-concentration"><i class="fa fa-check"></i><b>5.1</b> Back to the evolution of concentration</a></li>
<li class="chapter" data-level="5.2" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#interpretation-in-terms-of-exposure-ages"><i class="fa fa-check"></i><b>5.2</b> Interpretation in terms of exposure ages</a></li>
<li class="chapter" data-level="5.3" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#time-varying-production-rates"><i class="fa fa-check"></i><b>5.3</b> Time varying production rates</a></li>
<li class="chapter" data-level="5.4" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#dealing-with-uncertainties"><i class="fa fa-check"></i><b>5.4</b> Dealing with uncertainties</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html"><i class="fa fa-check"></i><b>6</b> Application to denudation rate measurements</a>
<ul>
<li class="chapter" data-level="6.1" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#concentration---denudation-rate-relationship"><i class="fa fa-check"></i><b>6.1</b> Concentration - denudation rate relationship</a></li>
<li class="chapter" data-level="6.2" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#integration-time-scale"><i class="fa fa-check"></i><b>6.2</b> Integration time scale</a></li>
<li class="chapter" data-level="6.3" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#change-in-denudation-through-time"><i class="fa fa-check"></i><b>6.3</b> Change in denudation through time</a></li>
<li class="chapter" data-level="6.4" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#on-the-importance-of-muons"><i class="fa fa-check"></i><b>6.4</b> On the importance of muons</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html"><i class="fa fa-check"></i><b>7</b> Two nuclides systems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#evolution-of-ratios"><i class="fa fa-check"></i><b>7.1</b> Evolution of ratios</a></li>
<li class="chapter" data-level="7.2" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#steady-state-denudation-and-constant-exposure-curves"><i class="fa fa-check"></i><b>7.2</b> Steady-state denudation and constant exposure curves</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exploring-tcn-build-up-at-the-surface" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">4</span> Exploring TCN build up at the surface<a href="exploring-tcn-build-up-at-the-surface.html#exploring-tcn-build-up-at-the-surface" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>We are going to consider simple computations of concentration under various conditions in terms of erosion, depth or age.
This will be done using an <em>Eulerian point of view</em>, which is the most straightforward and fastest way to perform such computation.
In this case the quantity of interest (concentration) is computed at fixed depths below the surface, while the exhumed material is moving through this reference frame during its trajectory toward the surface.
More details on the differences between Eulerian and Lagrangian approaches, and their applications to complex exposition/denudation histories, will be studied later.</p>
<p>Note that interpreting measured concentrations in terms of end-member situations of <em>pure exposure</em> or <em>steady-state denudation</em> is often done with online calculators (<span class="citation">Balco et al. (<a href="two-nuclides-systems.html#ref-balco2008complete" role="doc-biblioref">2008</a>)</span>,<span class="citation">Marrero et al. (<a href="two-nuclides-systems.html#ref-marrero2016cronusearth" role="doc-biblioref">2016</a>)</span>,<span class="citation">Martin et al. (<a href="two-nuclides-systems.html#ref-martin2017crep" role="doc-biblioref">2017</a>)</span>).
This will be fine in many cases, but you should always be careful about the underlying hypothesis (no erosion, steady state achieved…) when interpreting your concentrations and always think about how TCN are accumulating.
The goal of this activity is to explore this behavior.</p>
<div id="background" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Background<a href="exploring-tcn-build-up-at-the-surface.html#background" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The relevant general equation is the following,</p>
<p><span class="math display">\[
C=C_0e^{-\lambda t} + \sum_i \frac{P_i}{\frac{\rho \varepsilon}{\Lambda_i}+\lambda}e^{\frac{-\rho z}{\Lambda_i}}(1-e^{-(\frac{\rho \varepsilon}{\Lambda_i}+\lambda)t})
\]</span> with the following variables and parameters,</p>
<ul>
<li><span class="math inline">\(C\)</span> the concentration (as a function of time <span class="math inline">\(t\)</span> and depth <span class="math inline">\(z\)</span>)</li>
<li><span class="math inline">\(C_0\)</span> the inherited concentration</li>
<li><span class="math inline">\(\lambda\)</span> the decay constant for the considered nuclide</li>
<li><span class="math inline">\(P_i\)</span> the scaled surface production rate for the nuclide of interest and the <span class="math inline">\(i\)</span>-th production pathway (spallation, stopped muons, fast muons)</li>
<li><span class="math inline">\(\rho\)</span> the density of the medium</li>
<li><span class="math inline">\(\Lambda_i\)</span> the attenuation length for the particules of the <span class="math inline">\(i\)</span>-th production pathway</li>
<li><span class="math inline">\(\varepsilon\)</span> surface denudation</li>
</ul>
<p>In order to stick with usual conventions in the following time <span class="math inline">\(t\)</span> will be measured in years (a), the unit of length will be cm and the depths (<span class="math inline">\(z\)</span>) will be expressed in g/cm<span class="math inline">\(^2\)</span> (i.e. actual depth <span class="math inline">\(\times \rho\)</span>).</p>
<p>Note two keys limitations of this representation :</p>
<ul>
<li>it does not allow to account for time variations of production rates (at least in its most straightforward implementation), so we will mostly using the <em>st</em> scaling</li>
<li>it assumes exponential evolution of production with depth, which is clearly not the case for low energy neutrons (figure 2b from <span class="citation">Gosse and Phillips (<a href="two-nuclides-systems.html#ref-gosse2001terrestrial" role="doc-biblioref">2001</a>)</span>) and is questionable in some situations for muons (<span class="citation">Balco (<a href="two-nuclides-systems.html#ref-balco2017production" role="doc-biblioref">2017</a>)</span>)</li>
</ul>
</div>
<div id="set-up-of-the-calculations" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Set up of the calculations<a href="exploring-tcn-build-up-at-the-surface.html#set-up-of-the-calculations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We should the define the basic parameters we are going to use for the computation, which are two vectors :</p>
<ul>
<li>a vector with the attenuation lengths for different particles (in g/cm<span class="math inline">\(^2\)</span>)
<ul>
<li>neutrons for spallation reactions <span class="math inline">\(\Lambda_{spal}\)</span></li>
<li>stopping muons <span class="math inline">\(\Lambda_{stop}\)</span></li>
<li>fast muons <span class="math inline">\(\Lambda_{fast}\)</span><br />
</li>
</ul></li>
<li>a vector (or matrix) with the SLHL production rates (in at/g/a), in this case for the <em>st</em> scaling scheme (<span class="citation">Stone (<a href="two-nuclides-systems.html#ref-stone2000air" role="doc-biblioref">2000</a>)</span>), and decay constant <span class="math inline">\(\lambda\)</span> (in 1/a) for the nuclide(s) of interest.</li>
</ul>
<p>For easy reference a set of data for these parameters is included in the <code>TCNtools</code> package, including Sea-Level High-Latitude production rates for the <code>st</code> scaling scheme.
Note that these often used SLHL values are defined for convenience, most calculators for exposure age work directly with the production rate value at calibration sites, and that they are always relative to the scaling scheme used (<span class="citation">Borchers et al. (<a href="two-nuclides-systems.html#ref-borchers2016geological" role="doc-biblioref">2016</a>)</span>).</p>
<p>We can first load the attenuation length data (g/cm<span class="math inline">\(^2\)</span>).
Documentation of this dataset is accessible with <code>?Lambda</code>.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Lambda) <span class="co"># we load a vector containing the attenuation length into the environment</span></span>
<span id="cb13-2"><a href="exploring-tcn-build-up-at-the-surface.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(Lambda)</span></code></pre></div>
</details>
<pre><code>## Lspal Lstop Lfast 
##   160  1500  4320</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb15-1" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">=</span> <span class="fl">2.7</span> <span class="co"># we also define the density (g/cm3)</span></span></code></pre></div>
</details>
<p>Some production and decay parameters can also be loaded.
Documentation of this dataset is accessible with <code>?prm</code>.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(prm) <span class="co"># we load a matrix containing the production/decay parameters into the environment</span></span>
<span id="cb16-2"><a href="exploring-tcn-build-up-at-the-surface.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(prm)</span></code></pre></div>
</details>
<pre><code>##               Be10         Al26          C14
## Pspal  4.01000e+00 2.793000e+01 1.224000e+01
## Pstop  1.20000e-02 8.400000e-01 3.310000e+00
## Pfast  3.90000e-02 8.100000e-02 0.000000e+00
## lambda 5.09667e-07 9.667325e-07 1.209681e-04</code></pre>
<p>We also need to define the properties of our site of interest and compute the relevant scaling parameters. As we already saw previously, this can easily be done with,</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb18-1" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb18-2"><a href="exploring-tcn-build-up-at-the-surface.html#cb18-2" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">45</span> <span class="co"># latitude in degrees</span></span>
<span id="cb18-3"><a href="exploring-tcn-build-up-at-the-surface.html#cb18-3" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb18-4"><a href="exploring-tcn-build-up-at-the-surface.html#cb18-4" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span></code></pre></div>
</details>
</div>
<div id="evolution-of-concentration-with-time" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Evolution of concentration with time<a href="exploring-tcn-build-up-at-the-surface.html#evolution-of-concentration-with-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To get a general overview of the behavior we are going to use directly the <code>solv_conc_eul</code> function, which allows to easily deal with various configurations. In the following sections we will go back to the key equations to get a better sense of the importance of various parameters
As always the documentation of the function, including its various arguments, can be obtained by typing <code>?solv_conc_eul</code> in the R console.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-1" aria-hidden="true" tabindex="-1"></a>nuc <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span> <span class="co"># &quot;Al26&quot;, &quot;C14&quot;</span></span>
<span id="cb19-2"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span>  <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">200e3</span>,<span class="at">length.out=</span><span class="dv">1000</span>) <span class="co"># a vector containing time from 0 to 100 ka by 100 a steps</span></span>
<span id="cb19-3"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="dv">0</span> <span class="sc">*</span> rho <span class="co"># depth at which we are going to perform the calculation (cm converted to g/cm2)</span></span>
<span id="cb19-4"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-4" aria-hidden="true" tabindex="-1"></a>C0 <span class="ot">=</span> <span class="dv">0</span> <span class="co"># inherited concentration (at/g)</span></span>
<span id="cb19-5"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-5" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="dv">0</span> <span class="sc">*</span> (<span class="dv">100</span><span class="sc">/</span><span class="fl">1e6</span><span class="sc">*</span>rho) <span class="co"># denudation rate expressed in m/Ma and converted in g/cm2/a</span></span>
<span id="cb19-6"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-6" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(z,ero,t,C0,prm[,nuc],S,Lambda) <span class="co"># compute concentration</span></span>
<span id="cb19-7"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t<span class="sc">/</span><span class="dv">1000</span>,C,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">ylab=</span><span class="st">&quot;Concentration (at/g)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time (ka)&quot;</span>)</span>
<span id="cb19-8"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb19-9"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="co"># see explanation for these  lines below</span></span>
<span id="cb19-10"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-10" aria-hidden="true" tabindex="-1"></a>Prod <span class="ot">=</span> <span class="fu">c</span>(prm[<span class="dv">1</span>,nuc]<span class="sc">*</span>S<span class="sc">$</span>Nneutrons,prm[<span class="dv">2</span>,nuc]<span class="sc">*</span>S<span class="sc">$</span>Nmuons,prm[<span class="dv">3</span>,nuc]<span class="sc">*</span>S<span class="sc">$</span>Nmuons) <span class="co"># scaled production vector (defined for the sake of clarity of the expressions below)</span></span>
<span id="cb19-11"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-11" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">=</span> prm[<span class="dv">4</span>,nuc] <span class="co"># radiactive decay</span></span>
<span id="cb19-12"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>,<span class="fu">sum</span>(Prod)<span class="sc">*</span><span class="dv">1000</span>,<span class="at">lty=</span><span class="dv">2</span>) <span class="co"># note that time is in ka on the plot</span></span>
<span id="cb19-13"><a href="exploring-tcn-build-up-at-the-surface.html#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">sum</span>(Prod<span class="sc">/</span>((ero<span class="sc">/</span>Lambda)<span class="sc">+</span>lambda)),<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/ck_5bis-1.png" width="672" /></p>
<p>Start with zero erosion (<span class="math inline">\(\varepsilon=0\)</span>), corresponding to the pure exposition of a surface.
We see here the progressive build-up of concentration though time and the establishment of balance between gains (production) and losses (denudation and decay) leading to the concentration plateau at steady state.</p>
<p>Two lines are added to the graph,</p>
<ul>
<li>The first one corresponds to the production slope <span class="math inline">\(\sum_i P_i\)</span>, how much nuclide you produce and how it would accumulate if you had no radioactive decay and no denudation.</li>
<li>The second one (horizontal) is the maximum value of concentration when steady state is achieved :
<span class="math display">\[ C_{max}=\sum_i \frac{P_i}{\frac{\rho \varepsilon}{\Lambda_i}+\lambda} \]</span></li>
</ul>
<blockquote>
<p><strong>TODO</strong></p>
</blockquote>
<ul>
<li>Change the maximum of the <code>t</code> vector until you see the influence of radioactive decay and the plateau.</li>
<li>Add some inheritance</li>
<li>Test the evolution with other nuclides (<span class="math inline">\(^{26}\)</span>Al and <span class="math inline">\(^{14}\)</span>C)</li>
</ul>
<p>You can also play around with this build up using this Shiny App :</p>
<p><a href="http://shinyproxy.osupytheas.fr/simple_accumulation" class="uri">http://shinyproxy.osupytheas.fr/simple_accumulation</a></p>
<p>Now try to modify the <code>ero</code> (always keeping it is in g/cm<span class="math inline">\(^2\)</span>/a) parameter above, to see its influence on time needed to reach steady state and the final concentration.</p>
</div>
<div id="two-end-member-situations" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Two end-member situations<a href="exploring-tcn-build-up-at-the-surface.html#two-end-member-situations" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>No we are going to build a summary plot showing the influence of both exposure and denudation.</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-1" aria-hidden="true" tabindex="-1"></a>altitude <span class="ot">=</span> <span class="dv">1000</span> <span class="co"># elevation in m</span></span>
<span id="cb20-2"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-2" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">=</span> <span class="dv">45</span> <span class="co"># latitude in degrees</span></span>
<span id="cb20-3"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-3" aria-hidden="true" tabindex="-1"></a>nuc <span class="ot">=</span> <span class="st">&quot;Be10&quot;</span></span>
<span id="cb20-4"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-4" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>altitude,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute atmospheric pressure at site</span></span>
<span id="cb20-5"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-5" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> <span class="fu">scaling_st</span>(P,latitude) <span class="co"># compute the scaling parameters according to Stone (2000)</span></span>
<span id="cb20-6"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-6" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span>  <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="fu">log10</span>(<span class="dv">1</span>),<span class="fu">log10</span>(<span class="fl">10e6</span>),<span class="at">length.out=</span><span class="dv">1000</span>) <span class="co"># time vector, log-spaced!</span></span>
<span id="cb20-7"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculation of the evolution of concentration for denudation = 0</span></span>
<span id="cb20-8"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-8" aria-hidden="true" tabindex="-1"></a>C <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,<span class="dv">0</span>,t,<span class="dv">0</span>,prm[,nuc],S,Lambda) <span class="co"># compute concentration for pure exposure</span></span>
<span id="cb20-9"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(t,C,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>,<span class="at">ylab=</span><span class="st">&quot;Concentration (at/g)&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time (a)&quot;</span>,<span class="at">log=</span><span class="st">&quot;xy&quot;</span>)</span>
<span id="cb20-10"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb20-11"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">max</span>(t),<span class="fu">max</span>(C),<span class="dv">0</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">adj=</span><span class="dv">0</span>) <span class="co"># label the curve</span></span>
<span id="cb20-12"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># now we make the same computation for other denudation rates</span></span>
<span id="cb20-13"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-13" aria-hidden="true" tabindex="-1"></a>ero <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">1000</span>) <span class="co"># erosion vector in m/Ma</span></span>
<span id="cb20-14"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-14" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(ero)){</span>
<span id="cb20-15"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-15" aria-hidden="true" tabindex="-1"></a>  e <span class="ot">=</span> ero[i] <span class="sc">*</span> (<span class="dv">100</span><span class="sc">/</span><span class="fl">1e6</span><span class="sc">*</span>rho) <span class="co"># convert denudation in g/cm2/a</span></span>
<span id="cb20-16"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-16" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">=</span> <span class="fu">solv_conc_eul</span>(<span class="dv">0</span>,e,t,<span class="dv">0</span>,prm[,nuc],S,Lambda) <span class="co"># compute concentration for pure exposure</span></span>
<span id="cb20-17"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(t,C,<span class="at">col=</span><span class="st">&quot;cornflowerblue&quot;</span>,<span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb20-18"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(<span class="fu">max</span>(t),<span class="fu">max</span>(C),ero[i],<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">adj=</span><span class="dv">0</span>) <span class="co"># label the curve</span></span>
<span id="cb20-19"><a href="exploring-tcn-build-up-at-the-surface.html#cb20-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p><img src="_main_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>Note that this a log-log plot. It is probably one of the most important figure to keep in mind when analyzing TCN concentrations. It clearly shows the existence of two end-member situations when interpreting these concentrations, in terms of exposure age or denudation rates, and the transition between the two.</p>
<blockquote>
<p><strong>TODO</strong> Think about a bit about the following points</p>
</blockquote>
<ul>
<li>What are the key hypothesis made when interpreting a TCN concentration in terms of
<ul>
<li>exposure age</li>
<li>surface denudation</li>
</ul></li>
<li>Can you think of geological/geomorphological situations where these hypotheses are violated?</li>
<li>Why are the plateau concentrations so different?</li>
<li>How is the time to reach the plateau changing and why?</li>
</ul>
</div>
<div id="interactive-shiny-app-1" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Interactive shiny app<a href="exploring-tcn-build-up-at-the-surface.html#interactive-shiny-app-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also explore dynamically the TCN build up using this embedded application, which use the same type of code.</p>
<iframe src="https://shinyproxy.osupytheas.fr/simple_accumulation/" width="672" height="1200px" data-external="1">
</iframe>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="scaling-factors.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-to-exposure-dating.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
