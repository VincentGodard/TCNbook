<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Scaling factors | A Minimal Book Example</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Scaling factors | A Minimal Book Example" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Scaling factors | A Minimal Book Example" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Vincent Godard" />


<meta name="date" content="2022-10-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="introduction.html"/>
<link rel="next" href="exploring-tcn-build-up-at-the-surface.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a>
<ul>
<li class="chapter" data-level="2.1" data-path="introduction.html"><a href="introduction.html#objectives-of-the-session"><i class="fa fa-check"></i><b>2.1</b> Objectives of the session</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="scaling-factors.html"><a href="scaling-factors.html"><i class="fa fa-check"></i><b>3</b> Scaling factors</a>
<ul>
<li class="chapter" data-level="3.1" data-path="scaling-factors.html"><a href="scaling-factors.html#time-independent-scaling"><i class="fa fa-check"></i><b>3.1</b> Time-independent scaling</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="scaling-factors.html"><a href="scaling-factors.html#site-characteristics"><i class="fa fa-check"></i><b>3.1.1</b> Site characteristics</a></li>
<li class="chapter" data-level="3.1.2" data-path="scaling-factors.html"><a href="scaling-factors.html#computation-of-scaling-factors"><i class="fa fa-check"></i><b>3.1.2</b> Computation of scaling factors</a></li>
<li class="chapter" data-level="3.1.3" data-path="scaling-factors.html"><a href="scaling-factors.html#global-variations"><i class="fa fa-check"></i><b>3.1.3</b> Global variations</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="scaling-factors.html"><a href="scaling-factors.html#time-dependent-scalings"><i class="fa fa-check"></i><b>3.2</b> Time-dependent scalings</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="scaling-factors.html"><a href="scaling-factors.html#definition-of-paleomagnetic-variations"><i class="fa fa-check"></i><b>3.2.1</b> Definition of paleomagnetic variations</a></li>
<li class="chapter" data-level="3.2.2" data-path="scaling-factors.html"><a href="scaling-factors.html#lalstone-modified-scaling-lm"><i class="fa fa-check"></i><b>3.2.2</b> Lal/Stone modified scaling (<em>lm</em>)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="scaling-factors.html"><a href="scaling-factors.html#interactive-shiny-app"><i class="fa fa-check"></i><b>3.3</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html"><i class="fa fa-check"></i><b>4</b> Exploring TCN build up at the surface</a>
<ul>
<li class="chapter" data-level="4.1" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#background"><i class="fa fa-check"></i><b>4.1</b> Background</a></li>
<li class="chapter" data-level="4.2" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#set-up-of-the-calculations"><i class="fa fa-check"></i><b>4.2</b> Set up of the calculations</a></li>
<li class="chapter" data-level="4.3" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#evolution-of-concentration-with-time"><i class="fa fa-check"></i><b>4.3</b> Evolution of concentration with time</a></li>
<li class="chapter" data-level="4.4" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#two-end-member-situations"><i class="fa fa-check"></i><b>4.4</b> Two end-member situations</a></li>
<li class="chapter" data-level="4.5" data-path="exploring-tcn-build-up-at-the-surface.html"><a href="exploring-tcn-build-up-at-the-surface.html#interactive-shiny-app-1"><i class="fa fa-check"></i><b>4.5</b> Interactive shiny app</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html"><i class="fa fa-check"></i><b>5</b> Application to exposure dating</a>
<ul>
<li class="chapter" data-level="5.1" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#back-to-the-evolution-of-concentration"><i class="fa fa-check"></i><b>5.1</b> Back to the evolution of concentration</a></li>
<li class="chapter" data-level="5.2" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#interpretation-in-terms-of-exposure-ages"><i class="fa fa-check"></i><b>5.2</b> Interpretation in terms of exposure ages</a></li>
<li class="chapter" data-level="5.3" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#time-varying-production-rates"><i class="fa fa-check"></i><b>5.3</b> Time varying production rates</a></li>
<li class="chapter" data-level="5.4" data-path="application-to-exposure-dating.html"><a href="application-to-exposure-dating.html#dealing-with-uncertainties"><i class="fa fa-check"></i><b>5.4</b> Dealing with uncertainties</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html"><i class="fa fa-check"></i><b>6</b> Application to denudation rate measurements</a>
<ul>
<li class="chapter" data-level="6.1" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#concentration---denudation-rate-relationship"><i class="fa fa-check"></i><b>6.1</b> Concentration - denudation rate relationship</a></li>
<li class="chapter" data-level="6.2" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#integration-time-scale"><i class="fa fa-check"></i><b>6.2</b> Integration time scale</a></li>
<li class="chapter" data-level="6.3" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#change-in-denudation-through-time"><i class="fa fa-check"></i><b>6.3</b> Change in denudation through time</a></li>
<li class="chapter" data-level="6.4" data-path="application-to-denudation-rate-measurements.html"><a href="application-to-denudation-rate-measurements.html#on-the-importance-of-muons"><i class="fa fa-check"></i><b>6.4</b> On the importance of muons</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html"><i class="fa fa-check"></i><b>7</b> Two nuclides systems</a>
<ul>
<li class="chapter" data-level="7.1" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#evolution-of-ratios"><i class="fa fa-check"></i><b>7.1</b> Evolution of ratios</a></li>
<li class="chapter" data-level="7.2" data-path="two-nuclides-systems.html"><a href="two-nuclides-systems.html#steady-state-denudation-and-constant-exposure-curves"><i class="fa fa-check"></i><b>7.2</b> Steady-state denudation and constant exposure curves</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Minimal Book Example</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="scaling-factors" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Scaling factors<a href="scaling-factors.html#scaling-factors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>First we are going to explore how the scaling factors are changing with elevation, latitude and time, and what is the impact on local production rates.</p>
<div id="time-independent-scaling" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Time-independent scaling<a href="scaling-factors.html#time-independent-scaling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We are going to present the most widely used and simplest scaling scheme known as Lal-Stone and often abbreviated as <strong>st</strong>. The main equations are presented in the reference article by <span class="citation">Stone (<a href="two-nuclides-systems.html#ref-stone2000air" role="doc-biblioref">2000</a>)</span> .</p>
<div id="site-characteristics" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> Site characteristics<a href="scaling-factors.html#site-characteristics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We first need to define some parameters concerning the site of interest :</p>
<ul>
<li>latitude <code>lat</code> in degrees</li>
<li>altitude <code>z</code> in meters (can be a vector or a scalar)</li>
<li>longitude <code>lon</code> in degrees, this is not used for <em>st</em> scaling (<span class="citation">Stone (<a href="two-nuclides-systems.html#ref-stone2000air" role="doc-biblioref">2000</a>)</span>), just in case we want to compute atmospheric pressure according to ERA40 (<span class="citation">Uppala et al. (<a href="two-nuclides-systems.html#ref-uppala2005era40" role="doc-biblioref">2005</a>)</span>).</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="scaling-factors.html#cb2-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">=</span> <span class="dv">30</span> <span class="co"># latitude</span></span>
<span id="cb2-2"><a href="scaling-factors.html#cb2-2" aria-hidden="true" tabindex="-1"></a>lon <span class="ot">=</span> <span class="dv">30</span> <span class="co"># longitude</span></span>
<span id="cb2-3"><a href="scaling-factors.html#cb2-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">3000</span>,<span class="at">by=</span><span class="dv">100</span>) <span class="co"># vector from 0 to 3000 m by 100 m increments</span></span></code></pre></div>
<p>Now we can compute the atmospheric pressure, with the function <code>atm_pressure</code> according to the two models available, and then plot for comparison.
Here <code>z</code> is a vector to see the variations over a range of elevations.</p>
<p>To get information about the usage of the function used here (for example what are the different models) type <code>?atm_pressure</code> in the R console.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="scaling-factors.html#cb3-1" aria-hidden="true" tabindex="-1"></a>P1 <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>z,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) </span>
<span id="cb3-2"><a href="scaling-factors.html#cb3-2" aria-hidden="true" tabindex="-1"></a>P2 <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>z,<span class="at">lat=</span>lat,<span class="at">lon=</span>lon,<span class="at">model=</span><span class="st">&quot;era40&quot;</span>)</span>
<span id="cb3-3"><a href="scaling-factors.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(P1,z,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Pressure (hPa)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Altitude (m)&quot;</span>,<span class="at">col=</span><span class="st">&quot;darkorange3&quot;</span>) </span>
<span id="cb3-4"><a href="scaling-factors.html#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(P2,z,<span class="at">lty=</span><span class="dv">2</span>,<span class="at">col=</span><span class="st">&quot;darkorange3&quot;</span>)</span>
<span id="cb3-5"><a href="scaling-factors.html#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;Stone 2000&quot;</span>,<span class="st">&quot;ERA40&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<blockquote>
<p><strong>TODO</strong> Modify <code>lat</code> and <code>lon</code> to see the effects on the pressure computed with the ERA40 model</p>
</blockquote>
</div>
<div id="computation-of-scaling-factors" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> Computation of scaling factors<a href="scaling-factors.html#computation-of-scaling-factors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We can now compute the scaling factors according to <span class="citation">Stone (<a href="two-nuclides-systems.html#ref-stone2000air" role="doc-biblioref">2000</a>)</span>.
Same as above, to get some information about the function (parameters definition) type <code>?st_scaling</code> in the R console.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="scaling-factors.html#cb4-1" aria-hidden="true" tabindex="-1"></a>st <span class="ot">=</span> <span class="fu">scaling_st</span>(P1,lat) <span class="co"># here we use the pressure according to Stone 2000 model</span></span>
<span id="cb4-2"><a href="scaling-factors.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(st)</span></code></pre></div>
<pre><code>##    Nneutrons    Nmuons
## 1  0.8300224 0.8330000
## 2  0.9026631 0.8751951
## 3  0.9789258 0.9190924
## 4  1.0593995 0.9647381
## 5  1.1446610 1.0121787
## 6  1.2352759 1.0614606
## 7  1.3317993 1.1126307
## 8  1.4347771 1.1657357
## 9  1.5447466 1.2208226
## 10 1.6622372 1.2779383
## 11 1.7877718 1.3371297
## 12 1.9218669 1.3984436
## 13 2.0650339 1.4619266
## 14 2.2177794 1.5276253
## 15 2.3806062 1.5955858
## 16 2.5540138 1.6658541
## 17 2.7384989 1.7384759
## 18 2.9345563 1.8134963
## 19 3.1426788 1.8909602
## 20 3.3633586 1.9709117
## 21 3.5970868 2.0533946
## 22 3.8443547 2.1384521
## 23 4.1056535 2.2261264
## 24 4.3814748 2.3164594
## 25 4.6723113 2.4094921
## 26 4.9786564 2.5052644
## 27 5.3010052 2.6038156
## 28 5.6398539 2.7051842
## 29 5.9957004 2.8094072
## 30 6.3690443 2.9165212
## 31 6.7603872 3.0265612</code></pre>
<p>The result is stored in <code>st</code> as a dataframe with as many rows as there are elements in the input pressure vector (<code>P1</code>) and two columns named <code>Nneutrons</code> and <code>Nmuons</code>, for the spallogenic and muogenic contributions, respectively.</p>
<p>We can plot the evolution with elevation, which illustrates the major influence of altitude of the sampling site in controlling the local production rate.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="scaling-factors.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(st<span class="sc">$</span>Nneutrons,z,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb6-2"><a href="scaling-factors.html#cb6-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Spallogenic st scaling factor (Stone 2000)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Altitude (m)&quot;</span>,</span>
<span id="cb6-3"><a href="scaling-factors.html#cb6-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;Latitude &quot;</span>,lat,<span class="st">&quot;°&quot;</span>,<span class="at">sep=</span><span class="st">&quot;&quot;</span>),<span class="at">col=</span><span class="st">&quot;darkorange3&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<blockquote>
<p><strong>TODO</strong> Modify <code>lat</code> to see the effects on the scaling factor</p>
</blockquote>
</div>
<div id="global-variations" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> Global variations<a href="scaling-factors.html#global-variations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In order to get a better idea of the variations with both latitude (from 0 to 90°) and elevation (from sea level to 3000 m) we can try the following plot.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="scaling-factors.html#cb7-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span><span class="dv">0</span>,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) <span class="co"># compute pressure</span></span>
<span id="cb7-2"><a href="scaling-factors.html#cb7-2" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">90</span>,<span class="at">by=</span><span class="dv">1</span>) <span class="co"># latitude vector</span></span>
<span id="cb7-3"><a href="scaling-factors.html#cb7-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">length</span>(lat) <span class="co"># size of vector</span></span>
<span id="cb7-4"><a href="scaling-factors.html#cb7-4" aria-hidden="true" tabindex="-1"></a>st <span class="ot">=</span> <span class="fu">scaling_st</span>(P,lat) <span class="co"># compute scaling</span></span>
<span id="cb7-5"><a href="scaling-factors.html#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lat,st<span class="sc">$</span>Nneutrons,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.5</span>,<span class="dv">12</span>),<span class="at">col=</span><span class="st">&quot;darkorange3&quot;</span>,</span>
<span id="cb7-6"><a href="scaling-factors.html#cb7-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">&quot;Latitude (°)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Spallogenic st scaling factor (Stone 2000)&quot;</span>)</span>
<span id="cb7-7"><a href="scaling-factors.html#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb7-8"><a href="scaling-factors.html#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(lat[n],st<span class="sc">$</span>Nneutrons[n],<span class="st">&quot;0 km&quot;</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">adj=</span><span class="dv">0</span>) <span class="co"># put label at the end of curve</span></span>
<span id="cb7-9"><a href="scaling-factors.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (z <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">500</span>,<span class="dv">3000</span>,<span class="at">by=</span><span class="dv">500</span>)){ <span class="co"># loop on elevations : same as above for a range of elevations</span></span>
<span id="cb7-10"><a href="scaling-factors.html#cb7-10" aria-hidden="true" tabindex="-1"></a>  P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span>z,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>) </span>
<span id="cb7-11"><a href="scaling-factors.html#cb7-11" aria-hidden="true" tabindex="-1"></a>  st <span class="ot">=</span> <span class="fu">scaling_st</span>(P,lat) </span>
<span id="cb7-12"><a href="scaling-factors.html#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(lat,st<span class="sc">$</span>Nneutrons,<span class="at">col=</span><span class="st">&quot;darkorange3&quot;</span>)</span>
<span id="cb7-13"><a href="scaling-factors.html#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">text</span>(lat[n],st<span class="sc">$</span>Nneutrons[n],z<span class="sc">/</span><span class="dv">1000</span>,<span class="at">cex=</span><span class="fl">0.5</span>,<span class="at">adj=</span><span class="dv">0</span>)</span>
<span id="cb7-14"><a href="scaling-factors.html#cb7-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>This dependence of the scaling factor on latitude is a direct consequence of the dipole structure of the Earth magnetic field, with a higher cosmic rays flux at high latitudes.</p>
</div>
</div>
<div id="time-dependent-scalings" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Time-dependent scalings<a href="scaling-factors.html#time-dependent-scalings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="definition-of-paleomagnetic-variations" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Definition of paleomagnetic variations<a href="scaling-factors.html#definition-of-paleomagnetic-variations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Time-dependent scaling factors allow to take into account the variations through time of the Earth magnetic field, which modulates the incoming cosmic ray flux. This is particularly important in exposure dating applications.</p>
<div id="virtual-dipole-moment" class="section level4 hasAnchor" number="3.2.1.1">
<h4><span class="header-section-number">3.2.1.1</span> Virtual Dipole Moment<a href="scaling-factors.html#virtual-dipole-moment" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We need to first define a time series for the Virtual Dipole Moment (VDM) variation, using the <code>get_vdm</code> function.</p>
<p>Several paleomagnetic database can be used.
The three options correspond to databases defined in <a href="https://crep.otelo.univ-lorraine.fr">Crep</a>.
We plot the three of them on the same graph.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="scaling-factors.html#cb8-1" aria-hidden="true" tabindex="-1"></a>time <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="fl">50e3</span>,<span class="at">length.out =</span> <span class="dv">1000</span>) <span class="co"># time vector from 0 to 50 ka BP, with 1000 regularly spaced elements</span></span>
<span id="cb8-2"><a href="scaling-factors.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb8-3"><a href="scaling-factors.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(time),<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">16</span>),<span class="at">xlab=</span><span class="st">&quot;Time (a BP)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;VDM (10^22 A.m^2)&quot;</span>)</span>
<span id="cb8-4"><a href="scaling-factors.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb8-5"><a href="scaling-factors.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># - Glopis</span></span>
<span id="cb8-6"><a href="scaling-factors.html#cb8-6" aria-hidden="true" tabindex="-1"></a>col1<span class="ot">=</span><span class="st">&quot;coral1&quot;</span></span>
<span id="cb8-7"><a href="scaling-factors.html#cb8-7" aria-hidden="true" tabindex="-1"></a>vdm1<span class="ot">=</span><span class="fu">get_vdm</span>(time,<span class="at">model=</span><span class="st">&quot;glopis&quot;</span>)</span>
<span id="cb8-8"><a href="scaling-factors.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,vdm1<span class="sc">/</span><span class="fl">1e22</span>,<span class="at">col=</span>col1)</span>
<span id="cb8-9"><a href="scaling-factors.html#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 2 - Musch</span></span>
<span id="cb8-10"><a href="scaling-factors.html#cb8-10" aria-hidden="true" tabindex="-1"></a>col2 <span class="ot">=</span> <span class="st">&quot;chartreuse&quot;</span></span>
<span id="cb8-11"><a href="scaling-factors.html#cb8-11" aria-hidden="true" tabindex="-1"></a>vdm2<span class="ot">=</span><span class="fu">get_vdm</span>(time,<span class="at">model=</span><span class="st">&quot;musch&quot;</span>)</span>
<span id="cb8-12"><a href="scaling-factors.html#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,vdm2<span class="sc">/</span><span class="fl">1e22</span>,<span class="at">col=</span>col2)</span>
<span id="cb8-13"><a href="scaling-factors.html#cb8-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 - lsd</span></span>
<span id="cb8-14"><a href="scaling-factors.html#cb8-14" aria-hidden="true" tabindex="-1"></a>col3 <span class="ot">=</span> <span class="st">&quot;cornflowerblue&quot;</span></span>
<span id="cb8-15"><a href="scaling-factors.html#cb8-15" aria-hidden="true" tabindex="-1"></a>vdm3<span class="ot">=</span><span class="fu">get_vdm</span>(time,<span class="at">model=</span><span class="st">&quot;lsd&quot;</span>)</span>
<span id="cb8-16"><a href="scaling-factors.html#cb8-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,vdm3<span class="sc">/</span><span class="fl">1e22</span>,<span class="at">col=</span>col3)</span>
<span id="cb8-17"><a href="scaling-factors.html#cb8-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;glopis&quot;</span>,<span class="st">&quot;musch&quot;</span>,<span class="st">&quot;lsd&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(col1,col2,col3),<span class="at">lty=</span><span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="cutoff-rigidity" class="section level4 hasAnchor" number="3.2.1.2">
<h4><span class="header-section-number">3.2.1.2</span> Cutoff Rigidity<a href="scaling-factors.html#cutoff-rigidity" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now we need to convert that into cutoff rigidity using <code>vdm2rc</code> function.
Such can be done using the following expression (<span class="citation">Martin et al. (<a href="two-nuclides-systems.html#ref-martin2017crep" role="doc-biblioref">2017</a>)</span>): <span class="math display">\[R_c = 14.3 \frac{M}{M_0}\cos^4 \lambda,\]</span> where <span class="math inline">\(M\)</span> is the moment of the Earth dipole field, <span class="math inline">\(M_0\)</span> the 2010 reference value for <span class="math inline">\(M\)</span> and <span class="math inline">\(\lambda\)</span> the latitude.
This corresponds to the default <code>model=elsasser54</code> in the <code>vdm2rc</code> function arguments.
A more complex formula proposed by <span class="citation">Lifton, Sato, and Dunai (<a href="two-nuclides-systems.html#ref-lifton2014scaling" role="doc-biblioref">2014</a>)</span> can be used with <code>model=lifton14</code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="scaling-factors.html#cb9-1" aria-hidden="true" tabindex="-1"></a>lat <span class="ot">=</span> <span class="dv">40</span></span>
<span id="cb9-2"><a href="scaling-factors.html#cb9-2" aria-hidden="true" tabindex="-1"></a>rc1a <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm1,lat)</span>
<span id="cb9-3"><a href="scaling-factors.html#cb9-3" aria-hidden="true" tabindex="-1"></a>rc1b <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm1,lat,<span class="at">model=</span><span class="st">&quot;lifton14&quot;</span>)</span>
<span id="cb9-4"><a href="scaling-factors.html#cb9-4" aria-hidden="true" tabindex="-1"></a>rc2a <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm2,lat)</span>
<span id="cb9-5"><a href="scaling-factors.html#cb9-5" aria-hidden="true" tabindex="-1"></a>rc2b <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm2,lat,<span class="at">model=</span><span class="st">&quot;lifton14&quot;</span>)</span>
<span id="cb9-6"><a href="scaling-factors.html#cb9-6" aria-hidden="true" tabindex="-1"></a>rc3a <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm3,lat)</span>
<span id="cb9-7"><a href="scaling-factors.html#cb9-7" aria-hidden="true" tabindex="-1"></a>rc3b <span class="ot">=</span> <span class="fu">vdm2rc</span>(vdm3,lat,<span class="at">model=</span><span class="st">&quot;lifton14&quot;</span>)</span>
<span id="cb9-8"><a href="scaling-factors.html#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb9-9"><a href="scaling-factors.html#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="cn">NA</span>,<span class="at">xlim=</span><span class="fu">range</span>(time),<span class="at">ylim=</span><span class="fu">range</span>(rc1a,rc2a,<span class="fu">na.omit</span>(rc3a)),<span class="at">xlab=</span><span class="st">&quot;Time (a BP)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Rc (GV)&quot;</span>)</span>
<span id="cb9-10"><a href="scaling-factors.html#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb9-11"><a href="scaling-factors.html#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc1a,<span class="at">col=</span>col1)</span>
<span id="cb9-12"><a href="scaling-factors.html#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc1b,<span class="at">col=</span>col1,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-13"><a href="scaling-factors.html#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc2a,<span class="at">col=</span>col2)</span>
<span id="cb9-14"><a href="scaling-factors.html#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc2b,<span class="at">col=</span>col2,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-15"><a href="scaling-factors.html#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc3a,<span class="at">col=</span>col3)</span>
<span id="cb9-16"><a href="scaling-factors.html#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(time,rc3b,<span class="at">col=</span>col3,<span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb9-17"><a href="scaling-factors.html#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,<span class="fu">c</span>(<span class="st">&quot;glopis&quot;</span>,<span class="st">&quot;musch&quot;</span>,<span class="st">&quot;lsd&quot;</span>,<span class="st">&quot;elsasser54&quot;</span>,<span class="st">&quot;lifton14&quot;</span>),<span class="at">col=</span><span class="fu">c</span>(col1,col2,col3,<span class="st">&quot;black&quot;</span>,<span class="st">&quot;black&quot;</span>),<span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>),<span class="at">cex=</span><span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<blockquote>
<p><strong>TODO</strong> change the latitude <code>lat</code> and observe the influence on <span class="math inline">\(R_c\)</span></p>
</blockquote>
</div>
</div>
<div id="lalstone-modified-scaling-lm" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Lal/Stone modified scaling (<em>lm</em>)<a href="scaling-factors.html#lalstone-modified-scaling-lm" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Once we have a <span class="math inline">\(R_c\)</span> time series we can compute the <em>lm</em> scaling factors using the <code>scaling_lm</code> function.
For that we will only use one elevation (<em>z=0</em>), so we recompute the atmospheric pressure.
We plot the corresponding time series, as well as the value of <em>st</em> scaling factor for reference.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="scaling-factors.html#cb10-1" aria-hidden="true" tabindex="-1"></a>P <span class="ot">=</span> <span class="fu">atm_pressure</span>(<span class="at">alt=</span><span class="dv">0</span>,<span class="at">model=</span><span class="st">&quot;stone2000&quot;</span>)</span>
<span id="cb10-2"><a href="scaling-factors.html#cb10-2" aria-hidden="true" tabindex="-1"></a>lm <span class="ot">=</span> <span class="fu">scaling_lm</span>(P,rc1a)</span>
<span id="cb10-3"><a href="scaling-factors.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(time,lm,<span class="at">type=</span><span class="st">&quot;l&quot;</span>,<span class="at">xlab=</span><span class="st">&quot;Time (a BP)&quot;</span>,<span class="at">ylab=</span><span class="st">&quot;Spallogenic lm scaling factor&quot;</span>)</span>
<span id="cb10-4"><a href="scaling-factors.html#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fu">scaling_st</span>(P,lat)<span class="sc">$</span>Nneutrons,<span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<blockquote>
<p><strong>TODO</strong> Explore the variations of the scaling factor by using various values for elevation <code>alt</code>, and different <span class="math inline">\(R_c\)</span> time-series. Look for the differences with the time-independant <code>st</code> scaling</p>
</blockquote>
</div>
</div>
<div id="interactive-shiny-app" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Interactive shiny app<a href="scaling-factors.html#interactive-shiny-app" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You can also explore dynamically the behavior of scaling parameters using this embedded application, which use the same type of code.</p>
<iframe src="https://shinyproxy.osupytheas.fr/production_rates/" width="672" height="1200px" data-external="1">
</iframe>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="introduction.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exploring-tcn-build-up-at-the-surface.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
